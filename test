<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE Main Premium Test Portal</title>
    <!-- MathJax for Professional Math Rendering -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --primary: #0d6efd;
            --success: #198754;
            --danger: #dc3545;
            --warning: #ffc107;
            --dark: #212529;
            --light: #f8f9fa;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            background-color: #f4f6f9;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
        }

        /* --- Login Screen --- */
        #login-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .login-card {
            background: white;
            padding: 2.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        .login-card h2 { color: var(--primary); margin-bottom: 20px; }
        .login-card input {
            width: 100%; padding: 12px; margin-bottom: 15px;
            border: 2px solid #ddd; border-radius: 8px; font-size: 1rem;
        }
        .login-card button {
            width: 100%; padding: 12px;
            background: var(--primary); color: white; border: none;
            border-radius: 8px; font-size: 1.1rem; cursor: pointer;
            transition: 0.3s;
        }
        .login-card button:hover { background: #0056b3; }

        /* --- Header --- */
        header {
            background: white;
            padding: 0 20px;
            height: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 10;
        }
        .brand { font-weight: 700; font-size: 1.2rem; color: var(--primary); }
        .timer {
            background: #333; color: #0f0;
            padding: 5px 15px; border-radius: 5px;
            font-family: monospace; font-size: 1.4rem;
        }

        /* --- Main Layout --- */
        .container { display: flex; flex: 1; overflow: hidden; }
        
        .question-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: white;
            position: relative;
        }
        
        /* Question Styling */
        .q-header {
            display: flex; justify-content: space-between;
            border-bottom: 2px solid #eee; padding-bottom: 15px;
            margin-bottom: 20px;
        }
        .q-badge {
            background: var(--primary); color: white;
            padding: 4px 10px; border-radius: 4px; font-size: 0.9rem;
        }
        .q-text {
            font-size: 1.1rem; /* Adjusted for better readability */
            margin-bottom: 25px;
            line-height: 1.7; /* Adjusted */
            color: #2c3e50;
        }
        
        /* Options */
        .options-grid { display: flex; flex-direction: column; gap: 15px; }
        .option-item {
            display: flex; align-items: center;
            padding: 12px 15px;
            border: 1px solid #ddd; border-radius: 8px;
            cursor: pointer; transition: 0.2s;
            font-size: 1rem; /* Adjusted */
        }
        .option-item:hover { background: #f8f9fa; border-color: var(--primary); }
        .option-item input { margin-right: 15px; transform: scale(1.3); }
        
        .integer-box input {
            padding: 10px; font-size: 1.2rem;
            border: 2px solid var(--primary); border-radius: 5px; width: 150px;
        }

        /* Buttons */
        .controls {
            margin-top: 40px;
            display: flex; justify-content: space-between; gap: 10px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px; border: none; border-radius: 6px;
            cursor: pointer; font-weight: 600; font-size: 1rem;
            color: white; transition: 0.2s;
        }
        .btn-prev { background: #6c757d; }
        .btn-clear { background: #dc3545; }
        .btn-mark { background: #ffc107; color: black; }
        .btn-next { background: var(--primary); }
        .btn-submit { background: #198754; }

        /* --- Sidebar --- */
        .sidebar {
            width: 320px; background: #f1f3f5;
            padding: 20px; border-left: 1px solid #ddd;
            display: flex; flex-direction: column;
        }

        .subject-tabs { display: flex; gap: 5px; margin-bottom: 15px; }
        .sub-tab {
            flex: 1; padding: 10px; border-radius: 5px;
            background: #e9ecef; border: 1px solid #dee2e6;
            cursor: pointer; font-weight: bold; text-align: center;
        }
        .sub-tab.active { background: var(--primary); color: white; border-color: var(--primary); }

        .palette {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; /* Changed to 5 columns */
            margin-bottom: 20px; overflow-y: auto; flex: 1;
            padding: 5px;
        }
        .p-btn {
            aspect-ratio: 1; background: white; border: 1px solid #ccc;
            border-radius: 5px; cursor: pointer; font-weight: bold;
            display: flex; align-items: center; justify-content: center;
        }
        .p-btn.current { border: 2px solid var(--primary); box-shadow: 0 0 5px var(--primary); }
        .p-btn.answered { background: var(--success); color: white; border-color: var(--success); }
        .p-btn.marked { background: #6610f2; color: white; }
        .p-btn.not-ans { background: var(--danger); color: white; }

        /* --- Premium Footer --- */
        .premium-footer {
            background: linear-gradient(90deg, #111, #222);
            color: #fff; text-align: center; padding: 12px;
            position: relative; overflow: hidden;
            font-size: 0.95rem; border-top: 3px solid gold;
        }
        .gold-text {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800; letter-spacing: 1px;
        }
        .premium-badge {
            background: gold; color: black; padding: 2px 8px;
            border-radius: 4px; font-size: 0.7rem; font-weight: bold;
            vertical-align: middle; margin-left: 8px;
        }

        /* --- Score Card --- */
        #score-card {
            display: none; height: 100%; flex-direction: column;
            justify-content: center; align-items: center;
            background: #fff; text-align: center; padding: 20px;
        }
        .score-circle {
            width: 150px; height: 150px; border-radius: 50%;
            background: var(--primary); color: white;
            display: flex; justify-content: center; align-items: center;
            font-size: 2.5rem; font-weight: bold; margin: 20px auto;
            box-shadow: 0 10px 20px rgba(13, 110, 253, 0.3);
        }
        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 20px; width: 100%; max-width: 600px;
        }
        .stat-box {
            padding: 15px; border-radius: 10px; color: white;
            font-weight: bold;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; order: -1; padding: 10px; }
            .palette { grid-template-columns: repeat(10, 1fr); }
            .controls { justify-content: center; }
            .btn { flex: 1; min-width: 100px; }
        }
    </style>
</head>
<body>

    <!-- Login -->
    <div id="login-screen">
        <div class="login-card">
            <h2>JEE Main Portal</h2>
            <p>Enter Password to Begin</p>
            <input type="password" id="pass" placeholder="Password">
            <button onclick="login()">Start Test</button>
            <div style="margin-top: 15px; font-size: 0.8rem; color: #aaa;">
                Made by Vivek | @Ruhvaan
            </div>
        </div>
    </div>

    <!-- Main Interface -->
    <div id="test-ui" style="display: none; height: 100%; flex-direction: column;">
        <header>
            <div class="brand">JEE MAIN CATALYST SERIES</div>
            <div class="timer" id="timer">03:00:00</div>
        </header>

        <div class="container">
            <div class="question-area">
                <div class="q-header">
                    <h3 id="q-num" style="margin:0;">Question 1</h3>
                    <div style="text-align: right;">
                        <span class="q-badge" id="q-type">MCQ</span>
                        <div id="q-marks" style="font-size:0.8rem; color:#666; margin-top:5px;">(+4, -1)</div>
                    </div>
                </div>

                <div id="q-content" class="q-text"></div>
                <div id="options-area" class="options-grid"></div>

                <div class="controls">
                    <button class="btn btn-prev" onclick="nav(-1)">Previous</button>
                    <button class="btn btn-mark" onclick="markReview()">Mark Review</button>
                    <button class="btn btn-clear" onclick="clearAns()">Clear</button>
                    <button class="btn btn-next" onclick="saveNext()">Save & Next</button>
                </div>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-submit" onclick="submitTest()">SUBMIT TEST</button>
                </div>
            </div>

            <div class="sidebar">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                    <div style="width: 40px; height: 40px; background: #ddd; border-radius: 50%; display:grid; place-items:center;">üë§</div>
                    <strong>Candidate</strong>
                </div>
                <div class="subject-tabs">
                    <button id="sub-btn-0" class="sub-tab active" onclick="switchSubject(0)">Physics</button>
                    <button id="sub-btn-1" class="sub-tab" onclick="switchSubject(1)">Chemistry</button>
                    <button id="sub-btn-2" class="sub-tab" onclick="switchSubject(2)">Mathematics</button>
                </div>
                <div class="palette" id="palette"></div>
                <div style="font-size: 0.75rem; display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                    <div><span style="color:var(--success)">‚ñ†</span> Answered</div>
                    <div><span style="color:var(--danger)">‚ñ†</span> Not Answered</div>
                    <div><span style="color:#6610f2">‚ñ†</span> Marked</div>
                    <div><span style="color:#ccc">‚ñ†</span> Not Visited</div>
                </div>
            </div>
        </div>

        <footer class="premium-footer">
            <span class="gold-text">Made by Vivek</span>
            <span style="color: #666; margin: 0 10px;">|</span>
            <span class="gold-text">Tg id @Ruhvaan</span>
            <span class="premium-badge">PREMIUM</span>
        </footer>
    </div>

    <!-- Score Card -->
    <div id="score-card">
        <h1 style="color: var(--primary);">Test Result Analysis</h1>
        <div class="score-circle">
            <div id="final-score">0</div>
        </div>
        <p style="color: #666;">Total Score (Max: 300)</p>
        
        <div class="stats-grid">
            <div class="stat-box" style="background: var(--success);">
                <div style="font-size: 2rem;" id="correct-count">0</div>
                <div>Correct</div>
            </div>
            <div class="stat-box" style="background: var(--danger);">
                <div style="font-size: 2rem;" id="wrong-count">0</div>
                <div>Incorrect</div>
            </div>
            <div class="stat-box" style="background: var(--warning); color: black;">
                <div style="font-size: 2rem;" id="attempt-count">0</div>
                <div>Attempted</div>
            </div>
            <div class="stat-box" style="background: #6c757d;">
                <div style="font-size: 2rem;" id="accuracy">0%</div>
                <div>Accuracy</div>
            </div>
        </div>
    </div>

    <script>
        const allQuestions = [
            // Physics: 20 Sec A + 5 Sec B
            { id: 1, subject: "Physics", type: "MCQ", ans: "D", text: "[https://image2url.com/images/1765707283177-6ad4bbba-6718-4b83-8061-a1f56b1b9f78.png]", opts: { A: "Each piece moves with speed v.", B: "Each piece moves with speed v/2.", C: "One of the pieces moves with speed v/2, the other moves with speed greater than v/2.", D: "Each piece moves with speed greater than v/2." } },
            { id: 2, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765707124248-7e77e967-473f-46b9-acd1-bd9290c8a7c2.png] In the following circuit diagram inductive reactance of inductor is 24Œ© and capacitive reactance of capacitor is 48Œ©, then reading of ammeter will be:", opts: { A: "5 A", B: "2.4 A", C: "2.0 A", D: "10 A" } },
            { id: 3, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765707408004-2f8545de-4488-4869-8305-7b42695a2bb1.png] The centre of mass of the shaded portion of the disc is : (The mass is uniformly distributed in the shaded portion) :", opts: { A: "R/20 to the left of A", B: "R/12 to the left of A", C: "R/20 to the right of A", D: "R/12 to the right of A" } },
            { id: 4, subject: "Physics", type: "MCQ", ans: "D", text: "A body of mass m moving along a straight line with velocity v, collides with a body of mass nm which is also moving with a velocity kv in the same direction. If the first body comes to rest after the collision, then the velocity of second body after the collision would be:", opts: { A: "\\(\\frac{nv}{1+nk}\\)", B: "\\(\\frac{nv}{1-nk}\\)", C: "\\((1-nk)v\\)", D: "\\(\\frac{(1+nk)v}{n}\\)" } },
            { id: 5, subject: "Physics", type: "MCQ", ans: "C", text: "[https://image2url.com/images/1765707476742-b0efda45-1c41-4f7b-949e-0d835d46eb5f.png] A particle with charge +q and mass m‚ÇÅ, moving under the influence of a uniform electric field E i and a uniform magnetic field B k, follows a trajectory from P to Q as shown. The velocities at P and Q are V i and -2V j. Choose the wrong statement.", opts: { A: "\\(E=\\frac{3mv^2}{4qa}\\)", B: "The rate of work done by the electric field at P is \\(\\frac{3mv^3}{4a}\\)", C: "The rate of work done by the electric field at P is 0.", D: "The rate of work done by both the fields at Q is 0." } },
            { id: 6, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765707676138-8fda0561-dec7-416a-9b31-3664ccf980ce.png] In the figure shown a coil of single turn is wound on a sphere of radius r and mass m. The plane of the coil is parallel to the inclined plane and lies in the equatorial plane of the sphere. If sphere is in rotational equilibrium the value of B is (current in the coil is i):", opts: { A: "\\(\\frac{mg}{\\pi ir}\\)", B: "\\(\\frac{mg\\sin\\theta}{\\pi i}\\)", C: "\\(\\frac{mgr \\sin\\theta}{\\pi i}\\)", D: "None" } },
            { id: 7, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765707725609-b28d872b-8686-49ae-830b-ee7d08bd292a.png] In the arrangement shown, the pendulum on the left is pulled aside. It is then released and allowed to collide with other pendulum which is at rest. A perfectly inelastic collision occurs and the system rises to a height h/4 . The ratio of the masses (m‚ÇÅ/m‚ÇÇ) of the pendulum is:", opts: { A: "1", B: "2", C: "3", D: "4" } },
            { id: 8, subject: "Physics", type: "MCQ", ans: "D", text: "[https://image2url.com/images/1765707831181-a023f2bc-2f0e-4fb4-9332-8c49d208cbf8.png] Shown in the figure is a circular loop of radius r and resistance R. A variable magnetic field of induction \\(B = e^{-t}\\) is established inside the coil. If the key (K) is closed at t = 0, the electrical power developed is equal to:", opts: { A: "\\(\\frac{10r^4}{R}\\)", B: "\\(\\frac{10r^3}{R}\\)", C: "\\(\\frac{\\pi r^2}{5R}\\)", D: "\\(\\frac{\\pi^2 r^4}{R}\\) (Note: PDF answer is D, but calculation implies a different constant)" } },
            { id: 9, subject: "Physics", type: "MCQ", ans: "C", text: "A particle is executing simple harmonic motion with a period T seconds and amplitude a (in meter). The shortest time it take to reach a point \\(\\frac{a}{\\sqrt{2}}\\) m from its mean position in seconds is:", opts: { A: "T/4", B: "T/6", C: "T/8", D: "T/16" } },
            { id: 10, subject: "Physics", type: "MCQ", ans: "C", text: "[https://image2url.com/images/1765707885442-27ffc391-3f6e-4e5f-b9db-5561782199d6.png] A ball is suspended by a thread of length L at the point O on an inclined wall as shown in the figure. The inclination of the wall with the vertical is Œ±. The thread is displaced through a small angle Œ≤ away from the vertical and the ball is released. If Œ± < Œ≤, find the period of oscillation of pendulum. Assume that any impact between the wall and the ball is elastic.", opts: { A: "\\(2\\pi\\sqrt{\\frac{L}{g}}[1 - \\cos^{-1}(\\frac{\\alpha}{\\beta})]\\)", B: "\\(2\\sqrt{\\frac{L}{g}}[1 - \\cos^{-1}(\\frac{\\alpha}{\\beta})]\\)", C: "\\(\\pi\\sqrt{\\frac{L}{g}} + 2\\sqrt{\\frac{L}{g}}\\sin^{-1}(\\frac{\\alpha}{\\beta})\\)", D: "\\(2\\pi - 2\\cos^{-1}(\\frac{\\alpha}{\\beta})\\)" } },
            { id: 11, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765707928734-3d053307-c425-4b84-9840-675b187e5d67.png] A straight tube of length l contains incompressible liquid of mass M and the closed tube is whirled in horizontal plane about one of the ends. If œâ is the uniform angular velocity, the force exerted by the liquid on the other end is:", opts: { A: "\\(\\frac{M l \\omega^2}{2}\\)", B: "\\(2Ml\\omega^2\\)", C: "\\(\\frac{Ml\\omega^2}{4}\\)", D: "\\(Ml\\omega^2\\)" } },
            { id: 12, subject: "Physics", type: "MCQ", ans: "D", text: "[https://image2url.com/images/1765708013488-c1ce3276-9132-4ff1-92f8-2dff274a0219.png] In the circuit shown in the figure the ac source gives a voltage V = 20cos(2000t). Neglecting source resistance, the voltmeter and ammeter reading will be:", opts: { A: "0V, 0.47A", B: "1.68V, 0.47A", C: "0V, 1.4A", D: "5.6V, 1.4A" } },
            { id: 13, subject: "Physics", type: "MCQ", ans: "B", text: "[https://image2url.com/images/1765708053469-d4c41543-036f-4aea-bfa1-0e4411db9b22.png] Two particles of equal mass m are projected from the ground with speed v‚ÇÅ and v‚ÇÇ at angle Œ∏‚ÇÅ and Œ∏‚ÇÇ (Œ∏‚ÇÅ, Œ∏‚ÇÇ ‚â† 0, 180¬∫) as shown in figure. The centre of mass of the two particles:", opts: { A: "will move in a parabolic path for any values of v‚ÇÅ, v‚ÇÇ, Œ∏‚ÇÅ and Œ∏‚ÇÇ", B: "can move in a vertical line", C: "can move in a horizontal line", D: "will move in a straight line for any value of v‚ÇÅ, v‚ÇÇ, Œ∏‚ÇÅ and Œ∏‚ÇÇ" } },
            { id: 14, subject: "Physics", type: "MCQ", ans: "A", text: "The magnitude of average acceleration in half time period from equilibrium position in a simple harmonic motion is:", opts: { A: "\\(\\frac{2A\\omega^2}{\\pi}\\)", B: "\\(\\frac{A\\omega^2}{2\\pi}\\)", C: "\\(A\\omega^2\\)", D: "Zero" } },
            { id: 15, subject: "Physics", type: "MCQ", ans: "B", text: "An emf of 15 volt is applied in a circuit containing 5 henry inductance and 10 ohm resistance. The ratio of the currents at time t = ‚àû and at t = 1 second is:", opts: { A: "\\(\\frac{e^{1/2}}{e^{1/2}-1}\\)", B: "\\(\\frac{e^2}{e^2-1}\\)", C: "\\(1-e^{-1}\\)", D: "\\(e^{-1}\\)" } },
            { id: 16, subject: "Physics", type: "MCQ", ans: "A", text: "A bulb of 60 volt and 10 watt is connected with 100 volt of ac source with an inductance coil in series. If bulb illuminates with its full intensity then value of inductance of coil is (ŒΩ = 60 Hz):", opts: { A: "1.28 H", B: "2.15 H", C: "3.27 H", D: "3.89 H" } },
            { id: 17, subject: "Physics", type: "MCQ", ans: "D", text: "[https://image2url.com/images/1765708099045-1c672665-b0a8-421c-a2fb-c86b4735c050.png] A large free mass M and a small mass m are connected to a string such that m moves in horizontal circle. Length of string is l and Œ∏ is the angle this length makes with vertical. The frequency of rotation of mass m so that M remains at rest is:", opts: { A: "\\(\\frac{1}{2\\pi}\\sqrt{\\frac{mg}{ml}}\\)", B: "\\(\\frac{1}{2\\pi}\\frac{mg}{Ml}\\)", C: "\\(\\frac{1}{2\\pi}\\sqrt{\\frac{ml}{Mg}}\\)", D: "\\(\\frac{1}{2\\pi}\\sqrt{\\frac{Mg}{ml}}\\)" } },
            { id: 18, subject: "Physics", type: "MCQ", ans: "A", text: "Two particles execute SHM of the same amplitude and frequency along the same straight line. They pass one another when going in opposite directions, each time their displacement is half of their amplitude. What is the phase difference between them?", opts: { A: "2œÄ/3", B: "œÄ/3", C: "œÄ", D: "œÄ/2" } },
            { id: 19, subject: "Physics", type: "MCQ", ans: "B", text: "A circular coil of 100 turns has an effective radius 0.05m and carries a current of 0.1 ampere. How much work is required to turn it in an external magnetic field of 1.5 weber/m¬≤ through 180¬∞ about an axis perpendicular to the magnetic field. The plane of the coil is initially perpendicular to the magnetic field.", opts: { A: "1.8 J", B: "0.236 J", C: "2.4 J", D: "0.118 J" } },
            { id: 20, subject: "Physics", type: "MCQ", ans: "A", text: "[https://image2url.com/images/1765708165416-d78f9f1a-2e8e-40d3-a081-6af4567cf357.png] A particle of mass m moving with horizontal speed 6 m/sec. If m<<M then for one dimensional elastic collision, the speed of lighter particle after collision will be:", opts: { A: "2 m/sec in original direction", B: "2 m/sec opposite to the original direction", C: "4 m/sec opposite to the original direction", D: "4 m/sec in original direction" } },
            { id: 21, subject: "Physics", type: "INTEGER", ans: "2", text: "[https://image2url.com/images/1765708203963-7fb6b575-00e4-4fff-a162-1b945beb9f4c.png] A small body is released from point A of smooth parabolic path y = x¬≤, where y is vertical axis and x is horizontal axis at ground, as shown. The body leaves the surface from point B. If g = 10 m/s‚Åª¬≤ then what is the value of d (in m)?", opts: {} },
            { id: 22, subject: "Physics", type: "INTEGER", ans: "1", text: "[https://image2url.com/images/1765708245957-7bee3f82-7fe7-49ed-a73c-7fc100b11954.png] A plane loop is shaped in the form as shown in figure with radii a = 20 cm and b = 10 cm and is placed in a uniform time varying magnetic field B = B‚ÇÄ sin(œât), where B‚ÇÄ = 10 mT and œâ = 100 rad/s. Find the amplitude of the current induced in the loop if its resistance per unit length is equal to 50 x 10‚Åª¬≥ Œ©/m. The inductance of the loop is negligible.", opts: {} },
            { id: 23, subject: "Physics", type: "INTEGER", ans: "10", text: "[https://image2url.com/images/1765708275912-dcb28a76-2c6d-467e-967d-ebde7522d626.png] In the reported figure, two bodies A and B of masses 200g and 800g are attached with the system of springs. Springs are kept in a stretched position with some extension when the system is released. The horizontal surface is assumed to be frictionless. The angular frequency will be ___ rad/s when k=20N/m.", opts: {} },
            { id: 24, subject: "Physics", type: "INTEGER", ans: "220", text: "A bullet of mass 0.01kg and travelling at a speed of 500 m/s strikes and passes horizontally through a block of mass 2kg which is suspended by a string of length 5m. The centre of gravity of the block is found to raise a vertical distance of 0.1 m. What is the speed of the bullet after it emerges from the block. [g = 9.8m/s¬≤] (time of passing of bullet is negligible)", opts: {} },
            { id: 25, subject: "Physics", type: "INTEGER", ans: "2", text: "[https://image2url.com/images/1765708329179-5292039e-25c4-4558-b13a-0b8f9d3c36ca.png] At very high frequencies, the effective impedance of the given circuit will be ____ Œ©.", opts: {} },

            // Chemistry: 20 Sec A + 5 Sec B
            { id: 26, subject: "Chemistry", type: "MCQ", ans: "A", text: "Equimolar concentrations of H‚ÇÇ and I‚ÇÇ are heated to equilibrium in a 2 litre flask. The forward and the backward rate constants are found to be equal, what percentage of initial concentration of H‚ÇÇ has reacted at equilibrium for the reaction H‚ÇÇ + I‚ÇÇ ‚áå 2HI?", opts: { A: "33%", B: "66%", C: "50%", D: "40%" } },
            { id: 27, subject: "Chemistry", type: "MCQ", ans: "C", text: "Consider the reaction : NO(g) + O‚ÇÉ(g) ‚áå NO‚ÇÇ(g) + O‚ÇÇ(g) + 43.5kcal. If the reaction is in a closed vessel at a given temperature, consider the following changes: (P) Temperature is decreased, (Q) catalyst is added, (R) O‚ÇÉ is added, (S) pressure at equilibrium is reduced. Which changes would increase the amount of NO‚ÇÇ present at the new equilibrium.", opts: { A: "P and Q only", B: "Q and S only", C: "P and R only", D: "R and S only" } },
            { id: 28, subject: "Chemistry", type: "MCQ", ans: "C", text: "If Kp for a reaction is \\(\\frac{1}{9} \\times 10^{-2} \\text{ atm}^{-2}\\) at 500 K. Magnitude of Kc will be [Take R = 0.08 atm. lit/mol/K]", opts: { A: "\\(3 \\times 10^{-1}\\)", B: "\\(\\frac{1}{16} \\times 10^{-2}\\)", C: "\\(\\frac{16}{9}\\)", D: "\\(\\frac{9}{16} \\times 10^{-1}\\)" } },
            { id: 29, subject: "Chemistry", type: "MCQ", ans: "B", text: "How many times solubility of CaF‚ÇÇ is decreased in 4 √ó 10‚Åª¬≥ M KF(aq.) solution as compare to pure water at 25¬∞C. Given : Ksp(CaF‚ÇÇ) = 3.2 √ó 10‚Åª¬π¬π M¬≥", opts: { A: "50", B: "100", C: "500", D: "1000" } },
            { id: 30, subject: "Chemistry", type: "MCQ", ans: "C", text: "Find pH of solutions containing 0.02 M HA (Ka = 10‚Åª¬≤ M) [Given : log 2 = 0.3]", opts: { A: "1.85", B: "1.7", C: "2", D: "2.15" } },
            { id: 31, subject: "Chemistry", type: "MCQ", ans: "B", text: "Four separate solutions of equimolar concentration of sodium salts NaW, NaX, NaY and NaZ had pH 9.0, 7.0, 11.0 and 10.0 respectively. The strongest acid is:", opts: { A: "HW", B: "HX", C: "HY", D: "HZ" } },
            { id: 32, subject: "Chemistry", type: "MCQ", ans: "D", text: "The pH of blood stream is maintained by a proper balance of H‚ÇÇCO‚ÇÉ and NaHCO‚ÇÉ concentrations. What volume of 5 M NaHCO‚ÇÉ solution should be mixed with a 10 ml sample of blood which is 2M in H‚ÇÇCO‚ÇÉ in order to maintain a pH of 7.4 ? The value of Ka‚ÇÅ for H‚ÇÇCO‚ÇÉ in blood is 8.0 √ó 10‚Åª‚Å∑(log 2 = 0.3).", opts: { A: "20 ml", B: "10 ml", C: "40 ml", D: "80 ml" } },
            { id: 33, subject: "Chemistry", type: "MCQ", ans: "C", text: "Which of the following reaction gives 2-phenyl ethanamine as a product.", opts: { A: "[OPTION DIAGRAM A HERE]", B: "[OPTION DIAGRAM B HERE]", C: "[OPTION DIAGRAM C HERE]", D: "[OPTION DIAGRAM D HERE]" } },
            { id: 34, subject: "Chemistry", type: "MCQ", ans: "C", text: "Correct statement if organic compound (X), gives secondary sulphonamide (Y) on reaction with Hinsberg's regent is.", opts: { A: "Y is insoluble in Aq. NaOH", B: "X is secondary Amine", C: "Y is soluble in Aq. NaOH", D: "X is tertiary Amine" } },
            { id: 35, subject: "Chemistry", type: "MCQ", ans: "D", text: "[DIAGRAM HERE: User to add link for reaction scheme] Major product R is:", opts: { A: "[OPTION DIAGRAM A HERE]", B: "[OPTION DIAGRAM B HERE]", C: "[OPTION DIAGRAM C HERE]", D: "[OPTION DIAGRAM D HERE]" } },
            { id: 36, subject: "Chemistry", type: "MCQ", ans: "A", text: "[DIAGRAM HERE: User to add link for reaction scheme] If Y is S-(2)-Hydroxy propanoic acid then compound which is not having ‚ÄúS‚Äù configuration.", opts: { A: "P", B: "Q", C: "X", D: "Z" } },
            { id: 37, subject: "Chemistry", type: "MCQ", ans: "B", text: "[DIAGRAM HERE: User to add link for reaction scheme] Which is not obtained as a product?", opts: { A: "Ethanol", B: "Alanine", C: "Glycine", D: "Phthalic acid" } },
            { id: 38, subject: "Chemistry", type: "MCQ", ans: "B", text: "[DIAGRAM HERE: User to add link for reaction scheme] Major product obtained is:", opts: { A: "[OPTION DIAGRAM A HERE]", B: "[OPTION DIAGRAM B HERE]", C: "[OPTION DIAGRAM C HERE]", D: "[OPTION DIAGRAM D HERE]" } },
            { id: 39, subject: "Chemistry", type: "MCQ", ans: "B", text: "Which one of the following complexes will have \\(\\Delta_o = 0\\) and \\(\\mu = 5.96\\) B.M?", opts: { A: "[FeF‚ÇÜ]‚Å¥‚Åª", B: "[Mn(SCN)‚ÇÜ]‚Å¥‚Åª", C: "[Co(NH‚ÇÉ)‚ÇÜ]¬≥‚Å∫", D: "[Fe(CN)‚ÇÜ]‚Å¥‚Åª" } },
            { id: 40, subject: "Chemistry", type: "MCQ", ans: "C", text: "The correct order of [FeF‚ÇÜ]¬≥‚Åª, [CoF‚ÇÜ]¬≥‚Åª, [Ni(CO)‚ÇÑ] and [Ni(CN)‚ÇÑ]¬≤‚Åª complex species based on the number of unpaired electrons present is:", opts: { A: "[CoF‚ÇÜ]¬≥‚Åª > [FeF‚ÇÜ]¬≥‚Åª > [Ni(CO)‚ÇÑ] > [Ni(CN)‚ÇÑ]¬≤‚Åª", B: "[FeF‚ÇÜ]¬≥‚Åª > [CoF‚ÇÜ]¬≥‚Åª > [Ni(CN)‚ÇÑ]¬≤‚Åª > [Ni(CO)‚ÇÑ]", C: "[FeF‚ÇÜ]¬≥‚Åª > [CoF‚ÇÜ]¬≥‚Åª > [Ni(CN)‚ÇÑ]¬≤‚Åª = [Ni(CO)‚ÇÑ]", D: "[Ni(CN)‚ÇÑ]¬≤‚Åª > [FeF‚ÇÜ]¬≥‚Åª > [CoF‚ÇÜ]¬≥‚Åª > [Ni(CO)‚ÇÑ]" } },
            { id: 41, subject: "Chemistry", type: "MCQ", ans: "A", text: "'X' is the number of electrons in t‚ÇÇg orbitals of the most stable complex ion among [Fe(NH‚ÇÉ)‚ÇÜ]¬≥‚Å∫, [FeCl‚ÇÜ]¬≥‚Åª, [Fe(C‚ÇÇO‚ÇÑ)‚ÇÉ]¬≥‚Åª and [Fe(H‚ÇÇO)‚ÇÜ]¬≥‚Å∫. The nature of oxide of vanadium of the type V‚ÇÇO‚Çì is :", opts: { A: "Amphoteric", B: "Acidic", C: "Basic", D: "Neutral" } },
            { id: 42, subject: "Chemistry", type: "MCQ", ans: "B", text: "An octahedral complex having molecular composition Co.5NH‚ÇÉ.Cl‚ÇÇ.SO‚ÇÑ has two isomers A and B. The solution of A gives a white precipitate with AgNO‚ÇÉ solution and the solution of B gives white precipitate with BaCl‚ÇÇ solution. The type of isomerism exhibited by the complex is:", opts: { A: "Co-ordinate isomerism", B: "Ionisation isomerism", C: "Geometrical isomerism", D: "Linkage isomerism" } },
            { id: 43, subject: "Chemistry", type: "MCQ", ans: "A", text: "The number of unpaired electrons responsible for the paramagnetic nature of the following complex species are respectively: [Fe(CN)‚ÇÜ]¬≥‚Åª, [FeF‚ÇÜ]¬≥‚Åª, [CoF‚ÇÜ]¬≥‚Åª, [Mn(CN)‚ÇÜ]¬≥‚Åª", opts: { A: "1, 5, 4, 2", B: "1, 4, 4, 2", C: "1, 5, 5, 2", D: "1, 1, 4, 2" } },
            { id: 44, subject: "Chemistry", type: "MCQ", ans: "C", text: "Match List-I with List-II: (A) [Co(en)‚ÇÇCl‚ÇÇ]Cl, (B) [Pt(NH‚ÇÉ)‚ÇÇCl(NO‚ÇÇ)], (C) Hg[Co(SCN)‚ÇÑ], (D) [Mg(EDTA)]¬≤‚Åª. List II: (I) 3,6, (II) 2,4, (III) 2,6, (IV) 2,4", opts: { A: "(A)-(I), (B)-(III), (C)-(II), (D)-(IV)", B: "(A)-(II), (B)-(III), (C)-(IV), (D)-(I)", C: "(A)-(I), (B)-(IV), (C)-(II), (D)-(III)", D: "(A)-(III), (B)-(I), (C)-(II), (D)-(IV)" } },
            { id: 45, subject: "Chemistry", type: "MCQ", ans: "A", text: "Statement I: A homoleptic octahedral complex, formed using monodentate ligands, will not show stereoisomerism. Statement II: cis- and trans- platin are heteroleptic complexes of Pd.", opts: { A: "Statement I is true but Statement II is false", B: "Both Statement I and Statement II are true", C: "Both Statement I and Statement II are false", D: "Statement I is false but Statement II is true" } },
            { id: 46, subject: "Chemistry", type: "INTEGER", ans: "5", text: "For the equilibrium at 27¬∞C. LiCl¬∑3NH‚ÇÉ(s) ‚áå LiCl¬∑NH‚ÇÉ(s) + 2NH‚ÇÉ(g), Kp = 9 atm¬≤. A 24.63 litre flask contains 1 mol LiCl¬∑NH‚ÇÉ. How many moles of NH‚ÇÉ should be added to flask at this temperature to drive the backward reaction for completion. (R = 0.0821 atm L/mol/K)", opts: {} },
            { id: 47, subject: "Chemistry", type: "INTEGER", ans: "4", text: "The pH range of a basic indicator (InOH) is 3.4 ‚Äì 4.6. Determine the ratio [In‚Å∫]/[InOH] above which the solution appears only in the colour of In‚Å∫? (log 2 = 0.3)", opts: {} },
            { id: 48, subject: "Chemistry", type: "INTEGER", ans: "2", text: "If during following reaction mole ratio of Br‚ÇÇ & NaOH is used are Œ± & Œ≤ for per mole of [DIAGRAM FOR COMPOUND 1] & [DIAGRAM FOR COMPOUND 2]. Then value of (4Œ± + 5Œ≤) is.", opts: {} },
            { id: 49, subject: "Chemistry", type: "INTEGER", ans: "2", text: "Total number of amines obtained by gabriel pthalimide amine synthesis is from following: [DIAGRAM OF 5 AMINE STRUCTURES HERE]", opts: {} },
            { id: 50, subject: "Chemistry", type: "INTEGER", ans: "7", text: "The d-electronic configuration of [CoCl‚ÇÑ]¬≤‚Åª in tetrahedral crystal field is e·µêt‚ÇÇ‚Åø. Sum of 'm' and 'number of unpaired electrons' is:", opts: {} },
            
            // Mathematics: 20 Sec A + 5 Sec B
            { id: 51, subject: "Mathematics", type: "MCQ", ans: "D", text: "Consider a rectangle ABCD having 5, 7, 6, 9 points in the interior of the line segments AB, CD, BC, DA respectively. Let Œ± be the number of triangles having these points from different sides as vertices and Œ≤ be the number of quadrilaterals having these points from different sides as vertices. Then (Œ≤ ‚Äì Œ±) is equal to:", opts: { A: "1173", B: "795", C: "1890", D: "717" } },
            { id: 52, subject: "Mathematics", type: "MCQ", ans: "A", text: "The integral \\( \\int \\frac{(\\sqrt{3}-1)(\\cos x - \\sin x)}{(\\sin 2x + \\sqrt{3})} dx \\) is equal to:", opts: { A: "\\(\\frac{1}{2} \\ln|\\frac{\\tan(x/2+\\pi/12)}{\\tan(x/2-\\pi/12)}| + C\\)", B: "\\(\\frac{1}{2} \\ln|\\frac{\\tan(x/2+\\pi/6)}{\\tan(x/2-\\pi/3)}| + C\\)", C: "...", D: "..." } },
            { id: 53, subject: "Mathematics", type: "MCQ", ans: "C", text: "Consider the sequence a‚ÇÅ, a‚ÇÇ, a‚ÇÉ, ... such that a‚ÇÅ=1, a‚ÇÇ=2 and \\(a_{n+2} = \\frac{2}{a_{n+1}} + a_n\\). If \\(\\prod_{n=1}^{29} (1-\\frac{1}{a_{n+1}a_{n+2}}) = 2^\\alpha (61C31)\\), then Œ± is equal to:", opts: { A: "-30", B: "-31", C: "-60", D: "-61" } },
            { id: 54, subject: "Mathematics", type: "MCQ", ans: "A", text: "Let a be a positive real number such that \\(\\int_0^a e^{\\{x\\}}dx = 10e ‚Äì 9\\), where {x} is the fractional part of x. Then a is equal to:", opts: { A: "10 + log‚Çë 2", B: "10 + log‚Çë 3", C: "10 + log‚Çë(1+e)", D: "10 - log‚Çë(1+e)" } },
            { id: 55, subject: "Mathematics", type: "MCQ", ans: "D", text: "The number of seven digit integers with sum of the digits equal to 10 and formed by using the digits 1, 2 and 3 only is:", opts: { A: "82", B: "42", C: "35", D: "77" } },
            { id: 56, subject: "Mathematics", type: "MCQ", ans: "B", text: "The integral \\(\\int \\frac{e^{3\\log_e 2x} + 5e^{2\\log_e 2x}}{e^{4\\log_e x} + 5e^{3\\log_e x} - 7e^{2\\log_e x}} dx, x>0\\) is equal to:", opts: { A: "\\(\\log_e|x^2+5x-7| + c\\)", B: "\\(4\\log_e|x^2+5x-7| + c\\)", C: "\\(\\frac{1}{2}\\log_e|x^2+5x-7| + c\\)", D: "\\(\\log_e|\\sqrt{x^2+5x-7}| + c\\)" } },
            { id: 57, subject: "Mathematics", type: "MCQ", ans: "C", text: "Let n ‚â• 5 be an integer. If 9‚Åø ‚Äì 8n ‚Äì 1 = 64Œ± and 6‚Åø ‚Äì 5n ‚Äì 1 = 25Œ≤, then Œ± - Œ≤ is equal to:", opts: { A: "\\(1 + ^nC_2(8-5) + ...\\)", B: "\\(1 + ^nC_3(8-5) + ...\\)", C: "\\(^nC_3(8-5) + ^nC_4(8^2-5^2) + ...\\)", D: "\\(^nC_4(8-5) + ...\\)" } },
            { id: 58, subject: "Mathematics", type: "MCQ", ans: "A", text: "\\(\\lim_{n\\to\\infty} \\sum_{r=1}^n \\frac{n^2}{(n^2+r^2)(n+r)}\\) is equal to:", opts: { A: "\\(\\frac{\\pi}{8} + \\frac{1}{4}\\log_e 2\\)", B: "\\(\\frac{\\pi}{4} + \\frac{1}{2}\\log_e 2\\)", C: "\\(\\frac{\\pi}{2} - \\log_e 2\\)", D: "\\(\\frac{\\pi}{8} + \\log_e \\sqrt{2}\\)" } },
            { id: 59, subject: "Mathematics", type: "MCQ", ans: "D", text: "The value of \\(\\frac{d}{dx} [\\log_{\\sqrt{2}} (\\log_{\\cos x} \\csc x)]\\) at x = œÄ/4 is:", opts: { A: "-2‚àö2", B: "2‚àö2", C: "-4", D: "4" } },
            { id: 60, subject: "Mathematics", type: "MCQ", ans: "C", text: "The value of (2¬∑¬πP‚ÇÄ - 3¬∑¬≤P‚ÇÅ + 4¬∑¬≥P‚ÇÇ - ... up to 51th term) + (1! - 2! + 3! - ... up to 51th term) is equal to:", opts: { A: "1 ‚Äì 51(51)!", B: "1 + (51)!", C: "1 + (52)!", D: "1" } },
            { id: 61, subject: "Mathematics", type: "MCQ", ans: "B", text: "For natural numbers m, n, if (1‚Äìy)·µê(1+y)‚Åø = 1+a‚ÇÅy+a‚ÇÇy¬≤+... and a‚ÇÅ=a‚ÇÇ=10, then (m+n) is:", opts: { A: "100", B: "80", C: "88", D: "64" } },
            { id: 62, subject: "Mathematics", type: "MCQ", ans: "C", text: "The value of the integral \\(\\int_{-\\pi/2}^{\\pi/2} \\frac{dx}{(1+e^x)(\\sin x + \\cos x)}\\) is equal to:", opts: { A: "0", B: "œÄ/2", C: "œÄ", D: "2œÄ" } },
            { id: 63, subject: "Mathematics", type: "MCQ", ans: "A", text: "The number of 6 digit numbers that can be formed using the digits 0, 1, 2, 5, 7 and 9 which are divisible by 11 and no digit is repeated, is:", opts: { A: "60", B: "36", C: "72", D: "48" } },
            { id: 64, subject: "Mathematics", type: "MCQ", ans: "B", text: "The value of \\(\\int \\frac{\\sin\\theta \\cdot \\sin(2\\sin^6\\theta + \\sin^4\\theta + \\sin^2\\theta) \\cdot \\sin(2\\sin^4\\theta + 3\\sin^2\\theta + 6)}{(1+\\cos 2\\theta)} d\\theta\\) is...", opts: { A: "...", B: "\\(\\frac{1}{18} (2\\sin^6\\theta+3\\sin^4\\theta+6\\sin^2\\theta)^{3/2} + C\\)", C: "...", D: "..." } },
            { id: 65, subject: "Mathematics", type: "MCQ", ans: "C", text: "For x > 0, if \\(f(x) = \\int_1^x \\frac{\\log_e t}{1+t} dt\\), then \\(f(e) + f(1/e)\\) is equal to:", opts: { A: "1", B: "-1", C: "1/2", D: "0" } },
            { id: 66, subject: "Mathematics", type: "MCQ", ans: "D", text: "Let S be the set of all triangles in the xy-plane, each having one vertex at the origin and the other two vertices lie on coordinate axes with integral coordinates. If each triangle in S has area 50 sq. units, then the number of elements in the set S is:", opts: { A: "9", B: "32", C: "18", D: "36" } },
            { id: 67, subject: "Mathematics", type: "MCQ", ans: "D", text: "If \\(\\int (\\frac{2}{e^x-1} - \\frac{x}{e^{2x}-1}) dx = g(x) + c\\), where c is a constant of integration, then g(0) is equal to:", opts: { A: "e", B: "e¬≤", C: "1", D: "2" } },
            { id: 68, subject: "Mathematics", type: "MCQ", ans: "A", text: "The remainder when 2021¬≤‚Å∞¬≤¬≤ + 2022¬≤‚Å∞¬≤¬π is divided by 7 is:", opts: { A: "0", B: "1", C: "2", D: "6" } },
            { id: 69, subject: "Mathematics", type: "MCQ", ans: "C", text: "Let y = y(x) be a function of x satisfying \\(y\\sqrt{1-x^2} = k - x\\sqrt{1-y^2}\\) where k is a constant and y(1/2) = -1/2. Then \\(\\frac{dy}{dx}\\) at x=1/2 is equal to:", opts: { A: "5/4", B: "-5/2", C: "-5/4", D: "-2/5" } },
            { id: 70, subject: "Mathematics", type: "MCQ", ans: "B", text: "The letters of the word OUGHT are written in all possible ways and these words are arranged as in a dictionary, in a series. Then the serial number of the word TOUGH is:", opts: { A: "86", B: "89", C: "79", D: "84" } },
            { id: 71, subject: "Mathematics", type: "INTEGER", ans: "5", text: "The greatest integer less than or equal to \\(\\int_1^2 \\log_2(x^3+1)dx + \\int_1^{\\log_2 9}(2^x-1)^{1/3} dx\\) is:", opts: {} },
            { id: 72, subject: "Mathematics", type: "INTEGER", ans: "10", text: "If \\(\\alpha = \\int_0^1 e^{9x+3\\tan^{-1}x} (\\frac{12+9x^2}{1+x^2}) dx\\) where tan‚Åª¬πx takes only principal values, then the value of \\(\\log_e|1+\\alpha| - \\frac{3\\pi}{4}\\) is:", opts: {} },
            { id: 73, subject: "Mathematics", type: "INTEGER", ans: "16", text: "If \\(f(x) = \\int \\frac{5x^8+7x^6}{(x^2+1+2x^7)^2} dx, x \\ge 0\\) and f(0) = 0, then the value of f(1) is:", opts: {} },
            { id: 74, subject: "Mathematics", type: "INTEGER", ans: "1", text: "\\(f(x) = \\min(x+1, \\sqrt{1-x})\\) for all \\(x \\le 1\\). Then \\(\\int_{-1}^1 f(x) dx\\) is equal to:", opts: {} },
            { id: 75, subject: "Mathematics", type: "INTEGER", ans: "2", text: "Let \\(I_n = \\int_0^1 x^n \\tan^{-1}x dx\\). If \\(aI_{n+2} + bI_n = c_n\\) is a recurrence relation where a, b are integers and \\(c_n\\) depends on n, then the value of \\(a+b\\) is:", opts: {} }
        ];

        // --- Logic ---
        let currentSubjectIndex = 0;
        let currentQuestionIndex = 0; // Index within the filtered subject array
        let questions = []; // This will hold questions for the current subject
        let responses = {}; // { id: value }
        let status = {}; // { id: 'marked' | 'visited' | 'not-visited' }
        let timerTime = 180 * 60; // 3 HOURS
        let interval;
        let examActive = false;

        function login() {
            if (document.getElementById('pass').value === "Ruhvaan") {
                examActive = true;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('test-ui').style.display = 'flex';
                document.documentElement.requestFullscreen().catch(e => {});
                
                initStatus();
                switchSubject(0); // Start with Physics
                
                interval = setInterval(() => {
                    timerTime--;
                    let h = Math.floor(timerTime / 3600).toString().padStart(2, '0');
                    let m = Math.floor((timerTime % 3600) / 60).toString().padStart(2, '0');
                    let s = (timerTime % 60).toString().padStart(2, '0');
                    document.getElementById('timer').innerText = `${h}:${m}:${s}`;
                    if (timerTime <= 0) submitTest(true);
                }, 1000);
            } else {
                alert("Incorrect Password!");
            }
        }
        
        function initStatus() {
            allQuestions.forEach(q => {
                status[q.id] = 'not-visited';
            });
        }
        
        function switchSubject(subjectIndex) {
            currentSubjectIndex = subjectIndex;
            const subjectName = ["Physics", "Chemistry", "Mathematics"][subjectIndex];
            questions = allQuestions.filter(q => q.subject === subjectName);
            
            document.querySelectorAll('.sub-tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === subjectIndex);
            });
            
            initPalette();
            loadQ(0); // Load first question of the new subject
        }

        function initPalette() {
            const p = document.getElementById('palette');
            p.innerHTML = '';
            questions.forEach((q, i) => {
                const btn = document.createElement('div');
                btn.className = 'p-btn';
                btn.innerText = i + 1;
                btn.id = `pal-${q.id}`;
                btn.onclick = () => loadQ(i);
                p.appendChild(btn);
            });
            updatePalette();
        }

        function loadQ(idx) {
            currentQuestionIndex = idx;
            const q = questions[idx];
            
            if (status[q.id] === 'not-visited') {
                 status[q.id] = 'visited';
            }
            
            document.getElementById('q-num').innerText = `Question ${idx + 1}`;
            document.getElementById('q-type').innerText = q.type;
            document.getElementById('q-marks').innerText = q.type === 'MCQ' ? '(+4, -1)' : '(+4, 0)';
            
            const contentDiv = document.getElementById('q-content');
            contentDiv.innerHTML = q.text;
            
            const optsDiv = document.getElementById('options-area');
            optsDiv.innerHTML = '';
            
            const saved = responses[q.id] || '';

            if (q.type === 'MCQ') {
                Object.entries(q.opts).forEach(([key, val]) => {
                    const checked = saved === key ? 'checked' : '';
                    optsDiv.innerHTML += `
                    <label class="option-item">
                        <input type="radio" name="opt" value="${key}" ${checked}>
                        <span><strong>(${key})</strong> ${val}</span>
                    </label>`;
                });
            } else {
                optsDiv.innerHTML = `
                <div class="integer-box">
                    <label>Ans.</label>
                    <input type="text" id="int-input" value="${saved}">
                </div>`;
            }

            if (window.MathJax) MathJax.typesetPromise();
            updatePalette();
        }

        function saveNext() {
            const q = questions[currentQuestionIndex];
            let val = null;
            
            if (q.type === 'MCQ') {
                const el = document.querySelector('input[name="opt"]:checked');
                if (el) val = el.value;
            } else {
                const inputEl = document.getElementById('int-input');
                if (inputEl) val = inputEl.value.trim();
            }

            if (val) {
                responses[q.id] = val;
                if (status[q.id] !== 'marked') {
                    status[q.id] = 'answered';
                }
            }
            
            nav(1);
        }

        function markReview() {
            const q = questions[currentQuestionIndex];
            status[q.id] = 'marked';
            saveNext();
        }

        function clearAns() {
            const q = questions[currentQuestionIndex];
            delete responses[q.id];
            status[q.id] = 'visited';
            loadQ(currentQuestionIndex);
        }

        function nav(dir) {
            const next = currentQuestionIndex + dir;
            if (next >= 0 && next < questions.length) {
                loadQ(next);
            } else {
                updatePalette();
                alert("End of section. Please switch subjects.");
            }
        }

        function updatePalette() {
            questions.forEach((q) => {
                const btn = document.getElementById(`pal-${q.id}`);
                btn.className = 'p-btn'; // reset
                
                if (q.id === questions[currentQuestionIndex].id) btn.classList.add('current');
                
                const s = status[q.id];
                if (s === 'answered') {
                    btn.classList.add('answered');
                } else if (s === 'marked') {
                    btn.classList.add('marked');
                } else if (s === 'visited') {
                    btn.classList.add('not-ans');
                }
            });
        }

        function submitTest(force = false) {
            if (!force && !confirm("Are you sure you want to submit?")) return;
            
            examActive = false; // Disable anti-cheat
            clearInterval(interval);
            document.getElementById('test-ui').style.display = 'none';
            document.getElementById('score-card').style.display = 'flex';
            document.exitFullscreen().catch(e=>{});

            // Calc Score
            let correct = 0;
            let wrong = 0;
            let attempted = 0;
            
            allQuestions.forEach(q => {
                const userAns = responses[q.id];
                if (userAns) {
                    attempted++;
                    if (userAns.toString().trim().toLowerCase() === q.ans.toString().trim().toLowerCase()) {
                        correct++;
                    } else {
                        // Section B has 0 marks for wrong answer
                        if (q.type === 'MCQ') {
                           wrong++;
                        }
                    }
                }
            });

            const totalScore = (correct * 4) - (wrong * 1);
            const maxScore = allQuestions.length * 4;
            const accuracy = attempted ? ((correct / attempted) * 100).toFixed(1) : 0;

            document.getElementById('final-score').innerText = totalScore;
            document.getElementById('correct-count').innerText = correct;
            document.getElementById('wrong-count').innerText = wrong;
            document.getElementById('attempt-count').innerText = attempted;
            document.getElementById('accuracy').innerText = accuracy + '%';
        }

        // Anti-cheat warning
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && examActive) {
                alert("WARNING: Tab switch detected! Your test is monitored.");
            }
        });
    </script>
</body>
</html>
